## 错误和异常

在编码的时候，我们无时无刻会遇到错误和异常，所以我们需要处理这些错误。PHP 的错误类型有

- E_ERROR 致命的错误。会中断程序的执行
- E_Warning 警告。不会中断程序
- E_NOTICE 通知，运行时通知。表示脚本遇到可能会表现为错误的情况
- E_PARSE 解析错误，一般是语法错误。- E_STRICT   PHP 对代码的修改建议
- E_DEPRECATED 将会对在未来版本中可能无法正常工作的代码给出警告

### 错误

在开发模式中，我们一般需要打开 **error_reporting** 设置为 **E_ALL**。然后把 **display_errors** 设置为 on

如果需要记录错误日志，则需要配置 log_errors.

开发者可以 通过 Set_error_handle() 自己接管错误。```PHP

Set_error_handle(function($errno,$errstr,$errfile,$errline){})
  
/**
* throw exceptions based on E_* error types
*/
Set_error_Handler(function ($err_severity, $err_msg, $err_File, $err_line, array $err_context)
{
    // error was suppressed with the @-operator
    if (0 === error_reporting()) {return false;}
    switch($err_severity)
    {Case E_ERROR:               throw New ErrorException            ($err_msg, 0, $err_severity, $err_File, $err_line);
        Case E_Warning:             throw New WarningException          ($err_msg, 0, $err_severity, $err_File, $err_line);
        Case E_PARSE:               throw New ParseException            ($err_msg, 0, $err_severity, $err_File, $err_line);
        Case E_NOTICE:              throw New NoticeException           ($err_msg, 0, $err_severity, $err_File, $err_line);
        Case E_Core_ERROR:          throw New CoreErrorException        ($err_msg, 0, $err_severity, $err_File, $err_line);
        Case E_Core_Warning:        throw New CoreWarningException      ($err_msg, 0, $err_severity, $err_File, $err_line);
        Case E_COMPILE_ERROR:       throw New CompileErrorException     ($err_msg, 0, $err_severity, $err_File, $err_line);
        Case E_COMPILE_Warning:     throw New CoreWarningException      ($err_msg, 0, $err_severity, $err_File, $err_line);
        Case E_USER_ERROR:          throw New UserErrorException        ($err_msg, 0, $err_severity, $err_File, $err_line);
        Case E_USER_Warning:        throw New UserWarningException      ($err_msg, 0, $err_severity, $err_File, $err_line);
        Case E_USER_NOTICE:         throw New UserNoticeException       ($err_msg, 0, $err_severity, $err_File, $err_line);
        Case E_STRICT:              throw New StrictException           ($err_msg, 0, $err_severity, $err_File, $err_line);
        Case E_RECOVERABLE_ERROR:   throw New RecoverableErrorException ($err_msg, 0, $err_severity, $err_File, $err_line);
        Case E_DEPRECATED:          throw New DeprecatedException       ($err_msg, 0, $err_severity, $err_File, $err_line);
        Case E_USER_DEPRECATED:     throw New UserDeprecatedException   ($err_msg, 0, $err_severity, $err_File, $err_line);
    }
});

class WarningException              extends ErrorException {}
class ParseException                extends ErrorException {}
class NoticeException               extends ErrorException {}
class CoreErrorException            extends ErrorException {}
class CoreWarningException          extends ErrorException {}
class CompileErrorException         extends ErrorException {}
class CompileWarningException       extends ErrorException {}
class UserErrorException            extends ErrorException {}
class UserWarningException          extends ErrorException {}
class UserNoticeException           extends ErrorException {}
class StrictException               extends ErrorException {}
class RecoverableErrorException     extends ErrorException {}
class DeprecatedException           extends ErrorException {}
class UserDeprecatedException       extends ErrorException {}
```

#### PHP7 的错误处理

PHP 7 改变了大多数错误的报告方式。error 可以通过 exception 异常进行捕获到。 不能通过 try catch 捕获。但是可以通过注册到 Set_exception_handle 捕获。- Throwable
  - Error
  - Exception

```PHP
try
{// Code that May throw An Exception or Error.}
catch (Throwable $t)
{// Executed only in PHP 7, Will NOT match in PHP 5}
catch (Exception $e)
{// Executed only in PHP 5, Will NOT be reached in PHP 7}
```

### 异常

捕获异常可以通过 try catch 语句

```PHP
try{// 异常的代码}catch (Exception $e){// 处理异常}finally{// 最后执行的}
```

