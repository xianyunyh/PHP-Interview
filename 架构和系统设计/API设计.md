## REST API

REST（Representational State Transfer）表述性状态转换，**REST指的是一组架构约束条件和原则** 。

使用URL定位资源，用HTTP动词（GET,POST,PUT,DELETE)描述操作。 

### 基本概念

- 资源

  > 资源就是网络上的一个实体，一段文本，一张图片或者一首歌曲。资源总是要通过一种载体来反应它的内容。文本可以用TXT，也可以用HTML或者XML、图片可以用JPG格式或者PNG格式，JSON是现在最常用的资源表现形式。 

- 统一资源接口

  >  统一接口。RESTful风格的数据元操CRUD（create,read,update,delete）分别对应HTTP方法：GET用来获取资源，POST用来新建资源（也可以用于更新资源），PUT用来更新资源，DELETE用来删除资源，这样就统一了数据操作的接口。 

  - GET 获取资源
  - PUT更新资源
  - POST 新增资源
  - DELETE 删除

- URI

  > URI。可以用一个URI（统一资源定位符）指向资源，即每个URI都对应一个特定的资源。要获取这个资源访问它的URI就可以，因此URI就成了每一个资源的地址或识别符。一般的，每个资源至少有一个URI与之对应，最典型的URI就是URL。 

- 无状态

  > 所谓无状态即所有的资源都可以URI定位，而且这个定位与其他资源无关，也不会因为其他资源的变化而变化。有状态和无状态的区别，举个例子说明一下，例如要查询员工工资的步骤为第一步：登录系统。第二步：进入查询工资的页面。第三步：搜索该员工。第四步：点击姓名查看工资。这样的操作流程就是有状态的，查询工资的每一个步骤都依赖于前一个步骤，只要前置操作不成功，后续操作就无法执行。如果输入一个URL就可以得到指定员工的工资，则这种情况就是无状态的，因为获取工资不依赖于其他资源或状态，且这种情况下，员工工资是一个资源，由一个URL与之对应可以通过HTTP中的GET方法得到资源，这就是典型的RESTful风格。 



### 设计风格

- 协议

  API接口通讯，一般是通过HTTP[s]协议。

- 域名

  域名应单独部署到对应的域名。

  ```php
  api.github.com
  ```

- 版本控制

  ```
  api.github.com/v1/
  ```

- 路径规则

  路径中，不要出现动词。比如getUsers。复数表示获取集合数组

  ```
  /v1/user/10  获取id为10的用户
  /v1/users 获取所有用户
  ```

- HTTP请求方式表示动作

  - GET 表示获取资源
  - PUT 更新资源
  - POST新增资源
  - DELETE 删除资源

  ```
  GET /users
  PUT /user/10
  POST /user/10
  DELETE /user/10
  ```

- 过滤信息

  如果记录过多，可以使用分页过滤信息

  - ?limit=10 指定返回记录的数量 
  - ?offset=10：指定返回记录的开始位置。 
  - ?page=2&per_page=100：指定第几页，以及每页的记录数。 
  - ?sortby=name&order=asc：指定返回结果按照哪个属性排序，以及排序顺序 
  - ?producy_type=1：指定筛选条件 

- 异常响应

  当 RESTful API 接口出现非 2xx 的 HTTP 错误码响应时，采用全局的异常结构响应信息。

  